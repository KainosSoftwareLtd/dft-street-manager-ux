{% extends "alpha/v2-0/map-layout.html" %}

{% block page_title %}
Forward Planning - Street Manager
{% endblock %}

{% block content %}
<link rel="stylesheet" href="https://openlayers.org/en/v4.5.0/css/ol.css" type="text/css">
<script src="https://openlayers.org/en/v4.5.0/build/ol.js" type="text/javascript"></script>
<script src="/public/javascripts/map_styles.js"></script>
<script src="/public/javascripts/map_controls.js"></script>


<main id="content" role="main" style="padding:0px">
    <!-- alpha banner -->
    {% include "includes/phase_banner_alpha.html" %}
</main>

<div class="container">
    <div id="map" class="map" style="width: 100%"></div>
</div>

<div id="search-panel">
    <h1 class="heading-medium">How do you want to search?</h1>
    <form>
        <div class="form-group">
            <fieldset>
                <legend class="visuallyhidden">Enter postcode or charge ID to find a charge</legend>
                <div class="form-group spacing-bottom-half">
                    <label class="form-label" for="maintain-map-search">Search by postcode, address, UPRN, charge ID or title number
                    </label>
                    <input class="form-control" id="maintain-map-search" name="maintain-map-search" type="text" value="{{searchDetails}}" autofocus="autofocus">
                    <input id="map-search-button" class="button" type="button" name="maintain-map-search" value="Search">

                    <!--<input class="search-button submit maintain-map-search-button" type="submit" name="maintain-map-search" value=""> -->

                </div>
            </fieldset>
            <!--<p>You can also <a href="search_charge_id">find a charge by Charge ID</a></p> -->
        </div>
    </form>
</div>

<script type="text/javascript">

  var MAP_CONFIG = {};

  (function (MAP_CONFIG) {
    MAP_CONFIG.draw_layer_zindex = 2;
    // Draw Source
    MAP_CONFIG.draw_features = new ol.Collection();
    MAP_CONFIG.draw_controls = new MAP_CONTROLS.draw_controls();
    MAP_CONFIG.draw_source = new ol.source.Vector({ features: MAP_CONFIG.draw_features });
    MAP_CONFIG.draw_layer = new ol.layer.Vector({
      source: MAP_CONFIG.draw_source,
      style: draw_layer_styles.style[draw_layer_styles.NONE],
      zIndex: MAP_CONFIG.draw_layer_zindex
    })
    MAP_CONFIG.base_layer = new ol.layer.Tile({
      source: new ol.source.OSM()
    })
  })(MAP_CONFIG);

  var map = new ol.Map({
    target: 'map',
    /*layers: [
      new ol.layer.Tile({
        source: new ol.source.OSM()
      })
    ],*/
    layers: [MAP_CONFIG.base_layer, MAP_CONFIG.draw_layer],
    controls: ol.control.defaults({attribution: false}).extend([
      MAP_CONFIG.draw_controls
    ]),
    view: new ol.View({
      center: ol.proj.fromLonLat([-0.25, 51.5074]),
      zoom: 16
    })
  })

</script>

{% endblock %}