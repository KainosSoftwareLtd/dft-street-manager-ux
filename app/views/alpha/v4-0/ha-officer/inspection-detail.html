{% extends "layout.html" %}

{% block page_title %}
Inspection detail
{% endblock %}

{% block content %}

<main id="content" role="main">
    {% include "includes/phase_banner_alpha.html" %}

    <div class="breadcrumbs">
        <div>
            <!-- the rest of this label is hidden, only used for screenreaders -->
            <span class="visuallyhidden"> to the previous page</span>
            <a id="sign-out" href="sign_in" style="float:right">Sign out</a>
            <span style="float:right; margin-right:10px;">ha@sm.com</span>
        </div>
    </div>

    <a href="add-inspection.html" class="link-back" title="Back to previous question">Back</a>

    <div class="grid-row">
        <div class="column-full">

            <h1 class="heading-large">
                {% if data['workreferencenumber'] %}
                <span class="heading-secondary">
                    WRN {{ data['workreferencenumber'] }}
                </span>
                {% endif %}
                Inspections
            </h1>

            {% include "../templates/keyinfo.html" %}


            <div id="inspections-table">
                <h3 class="heading-medium">Inspections</h3>
                <table id="inspections">
                    <thead>
                    <th></th>
                    <th>Inspection date</th>
                    <th>Inspection type</th>
                    <th>Inspection outcome</th>
                    </thead>
                    <tbody>
                    <tr>
                        <td>Inspection 1</td>
                        <td id="date"></td>
                        <td id="type"></td>
                        <td id="outcome"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</main>

<script>
  (function () {

    // Auto populate date
    var today = new Date();
    $('#inspection-date-day').val(today.getDate().toString().padStart(2,'0'));
    $('#inspection-date-month').val((today.getMonth() + 1).toString().padStart(2,'0'));
    $('#inspection-date-year').val(today.getFullYear().toString());


    //  JS for attachment
    $("#upload-button").click(function () {
      var file = $('#inspection-attachments')[0].files[0];

      var fileName = file.name;
      var attachmentTitle = $("#attachment-title").val();
      var markup = "<tr><td><input type='hidden' name='inspection-attached-detail[]' value='"+ attachmentTitle+"'>" + attachmentTitle + "</td><td>PNG Image</td><td><input type='hidden' name='inspection-attached-name[]' value='" + fileName +"'>" + fileName + "</td><td><img src='/public/images/renteq.png' alt='Preview' width='150' height='150'/></td><td><span class=\"remove-attachment\"><a href=\"#\" onclick=\"removeAttachment(" + attachmentTitle + ")\">Remove</a></td></tr>";
      $("#attachment-table").append(markup);

      $("#attachments-table").removeClass("js-hidden");
      $("#file-name").val("");
      $("#attachment-title").val("");
    });


    $("#save").click(function () {
      $("#inspections-table").show();
      $("html, body").scrollTop(0);

      $("#date").text(function () {
        var returnDate =
          $("#inspection-date-day").val() + "/" +
          $("#inspection-date-month").val() + "/" +
          $("#inspection-date-year").val()
        return returnDate;
      });

      $("#type").text($("input[name=inspection-type-group]:checked").val());
      $("#outcome").text($("input[name=outcome-group]:checked").val());

      $("input[name=inspection-type-group]:checked").prop('checked', false);
      $("input[name=outcome-group]:checked").prop('checked', false);

    });

  })();
</script>

{% endblock %}



